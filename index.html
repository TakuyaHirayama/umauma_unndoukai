<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ã†ã¾ã†ã¾é‹å‹•ä¼š</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f5f5f5;
      padding: 20px;
    }
    h1 {
      text-align: center;
    }
    .horse {
      background: white;
      padding: 10px;
      margin: 10px 0;
      border-radius: 8px;
    }
    .bar {
      height: 20px;
      background: #ddd;
      border-radius: 10px;
      overflow: hidden;
      margin-top: 5px;
    }
    .bar-inner {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #4facfe, #00f2fe);
    }
    button {
      font-size: 18px;
      padding: 10px 30px;
      margin-top: 20px;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
    #result {
      margin-top: 30px;
      padding: 25px;
      text-align: center;
      font-size: 30px;
      font-weight: bold;
      background: linear-gradient(135deg, #ffe259, #ffa751);
      border-radius: 15px;
      display: none;
    }
    #stats {
      text-align: center;
      margin-top: 10px;
      font-size: 16px;
    }
  </style>
</head>
<body>

<h1>ğŸ‡ ã†ã¾ã†ã¾é‹å‹•ä¼š ğŸ‡</h1>

<div id="stats"></div>
<div id="horses"></div>

<button onclick="startRace()">ãƒ¬ãƒ¼ã‚¹é–‹å§‹ï¼</button>

<div id="result"></div>

<script>
const words = ["ã•ãã‚‰","ã‹ãœ","ã»ã—","ã‚„ã¾","ã‹ã‚","ã²ã‹ã‚Š","ã‚†ã","ãã‚‰","ã¤ã","ãŸã‘"];

let horses = [];
let raceDistance = 0;
let totalRaces = 0;
let hitRaces = 0;

// ä¹±æ•°
function rand(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

// é¦¬ç”Ÿæˆ
function generateHorses() {
  horses = [];
  raceDistance = rand(800, 2000);

  for (let i = 0; i < 4; i++) {
    const name =
      words[rand(0, words.length - 1)] +
      words[rand(0, words.length - 1)];

    const power = rand(50, 100);

    horses.push({
      name,
      power,
      progress: 0,
      score: 0
    });
  }
}

// è¡¨ç¤º
function displayHorses() {
  const div = document.getElementById("horses");
  div.innerHTML = `<p><strong>ãƒ¬ãƒ¼ã‚¹è·é›¢ï¼š${raceDistance}m</strong></p>`;

  horses.forEach((h, i) => {
    div.innerHTML += `
      <div class="horse">
        <input type="radio" name="predict" value="${i}">
        <strong>${h.name}</strong><br>
        èƒ½åŠ›å€¤ï¼š${h.power}
        <div class="bar">
          <div class="bar-inner" id="bar${i}"></div>
        </div>
      </div>
    `;
  });

  updateStats();
}

// çš„ä¸­ç‡è¡¨ç¤º
function updateStats() {
  const rate = totalRaces === 0 ? 0 : Math.round((hitRaces / totalRaces) * 100);
  document.getElementById("stats").innerHTML =
    `ğŸ¯ çš„ä¸­ç‡ï¼š${rate}%ï¼ˆ${hitRaces}/${totalRaces}ï¼‰`;
}

// ãƒ¬ãƒ¼ã‚¹é–‹å§‹
function startRace() {
  const checked = document.querySelector('input[name="predict"]:checked');
  if (!checked) {
    alert("äºˆæƒ³ã‚’é¸ã³ãªã‚µã‚¤ğŸ˜¤");
    return;
  }

  horses.forEach(h => {
    h.score = h.power + rand(0, 50) - raceDistance / 50;
    h.progress = 0;
  });

  const interval = setInterval(() => {
    horses.forEach((h, i) => {
      h.progress += rand(1, 5);
      document.getElementById(`bar${i}`).style.width =
        Math.min(h.progress, 100) + "%";
    });

    if (horses.some(h => h.progress >= 100)) {
      clearInterval(interval);
      finishRace(checked.value);
    }
  }, 100);
}

// çµæœå‡¦ç†
function finishRace(predictedIndex) {
  horses.sort((a, b) => b.score - a.score);
  const winner = horses[0];
  const predicted = horses[predictedIndex];

  totalRaces++;
  if (winner.name === predicted.name) hitRaces++;

  const resultDiv = document.getElementById("result");
  resultDiv.style.display = "block";
  resultDiv.innerHTML = `
    ğŸ† å„ªå‹é¦¬ ğŸ†<br><br>
    ${winner.name}<br><br>
    ${
      winner.name === predicted.name
        ? "ğŸ‰ äºˆæƒ³çš„ä¸­ï¼ï¼ãŠè¦‹äº‹ï¼ï¼ ğŸ‰"
        : "ğŸ’¥ äºˆæƒ³ãƒã‚ºãƒ¬â€¦æ¬¡ã¯å½“ã¦ãªã‚µã‚¤ ğŸ˜"
    }<br><br>
    <span style="font-size:16px;">æ¬¡ã®ãƒ¬ãƒ¼ã‚¹æº–å‚™ä¸­â€¦</span>
  `;

  updateStats();

  setTimeout(() => {
    resultDiv.style.display = "none";
    generateHorses();
    displayHorses();
  }, 3500);
}

// åˆæœŸåŒ–
generateHorses();
displayHorses();
</script>

</body>
</html>
